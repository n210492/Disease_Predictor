<!DOCTYPE html>
<html>
<head>
    <title>Disease Prediction System</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        h2 {
            color: #2c3e50;
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: inline-block;
            width: 200px;
            vertical-align: top;
        }
        input[type="number"] {
            width: 100px;
            padding: 5px;
        }
        .radio-group {
            display: inline-block;
            margin-right: 15px;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 16px;
            border-radius: 4px;
        }
        button:hover {
            background-color: #2980b9;
        }
        #output {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: #f9f9f9;
        }
        .prediction {
            margin-bottom: 10px;
            padding: 10px;
            background-color: #e8f4fc;
            border-radius: 4px;
        }
        .warning {
            color: #e74c3c;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>Disease Prediction System</h1>
    
    <form id="predictionForm">
        <div class="form-group">
            <label for="symptoms">Describe your symptoms:</label>
            <input type="text" id="symptoms" name="symptoms" required style="width: 400px;" 
                   placeholder="e.g., fever, headache, chest pain">
        </div>

        <h2>Clinical Data</h2>
        <div class="form-group">
            <label for="age">Age (1-100 years):</label>
            <input type="number" id="age" name="age" min="1" max="100" required>
        </div>
        <div class="form-group">
            <label for="weight">Weight (30-150 kg):</label>
            <input type="number" id="weight" name="weight" min="30" max="150" required>
        </div>
        <div class="form-group">
            <label for="bp">BP (60-200 mmHg):</label>
            <input type="number" id="bp" name="bp" min="60" max="200" required>
        </div>
        <div class="form-group">
            <label for="sugar">Sugar (50-300 mg/dL):</label>
            <input type="number" id="sugar" name="sugar" min="50" max="300" required>
        </div>
        <div class="form-group">
            <label for="cholesterol">Cholesterol (10-300 mg/dL):</label>
            <input type="number" id="cholesterol" name="cholesterol" min="10" max="300" required>
        </div>
        <div class="form-group">
            <label for="wbc">WBC (2-20 thousands/μL):</label>
            <input type="number" id="wbc" name="wbc" min="2" max="20" required>
        </div>
        <div class="form-group">
            <label for="bmi">BMI (5-30):</label>
            <input type="number" id="bmi" name="bmi" min="5" max="30" step="0.1" required>
        </div>
        <div class="form-group">
            <label for="sleep">Sleep (0-10 hours):</label>
            <input type="number" id="sleep" name="sleep" min="0" max="10" step="0.5" required>
        </div>

        <h2>Environmental Data</h2>
        <div class="form-group">
            <label>Temperature:</label>
            <div class="radio-group">
                <input type="radio" id="temp_low" name="temperature" value="low" required>
                <label for="temp_low" style="width: auto;">Low</label>
            </div>
            <div class="radio-group">
                <input type="radio" id="temp_medium" name="temperature" value="medium">
                <label for="temp_medium" style="width: auto;">Medium</label>
            </div>
            <div class="radio-group">
                <input type="radio" id="temp_high" name="temperature" value="high">
                <label for="temp_high" style="width: auto;">High</label>
            </div>
        </div>

        <div class="form-group">
            <label>Humidity:</label>
            <div class="radio-group">
                <input type="radio" id="humidity_low" name="humidity" value="low" required>
                <label for="humidity_low" style="width: auto;">Low</label>
            </div>
            <div class="radio-group">
                <input type="radio" id="humidity_medium" name="humidity" value="medium">
                <label for="humidity_medium" style="width: auto;">Medium</label>
            </div>
            <div class="radio-group">
                <input type="radio" id="humidity_high" name="humidity" value="high">
                <label for="humidity_high" style="width: auto;">High</label>
            </div>
        </div>

        <div class="form-group">
            <label>Air Quality:</label>
            <div class="radio-group">
                <input type="radio" id="air_bad" name="air_quality" value="bad" required>
                <label for="air_bad" style="width: auto;">Bad</label>
            </div>
            <div class="radio-group">
                <input type="radio" id="air_normal" name="air_quality" value="normal">
                <label for="air_normal" style="width: auto;">Normal</label>
            </div>
            <div class="radio-group">
                <input type="radio" id="air_good" name="air_quality" value="good">
                <label for="air_good" style="width: auto;">Good</label>
            </div>
        </div>

        <div class="form-group">
            <label>Water Quality:</label>
            <div class="radio-group">
                <input type="radio" id="water_bad" name="water_quality" value="bad" required>
                <label for="water_bad" style="width: auto;">Bad</label>
            </div>
            <div class="radio-group">
                <input type="radio" id="water_normal" name="water_quality" value="normal">
                <label for="water_normal" style="width: auto;">Normal</label>
            </div>
            <div class="radio-group">
                <input type="radio" id="water_good" name="water_quality" value="good">
                <label for="water_good" style="width: auto;">Good</label>
            </div>
        </div>

        <h2>Region Type</h2>
        <div class="form-group">
            <div class="radio-group">
                <input type="radio" id="region_urban" name="region" value="urban" required>
                <label for="region_urban" style="width: auto;">Urban</label>
            </div>
            <div class="radio-group">
                <input type="radio" id="region_rural" name="region" value="rural">
                <label for="region_rural" style="width: auto;">Rural</label>
            </div>
            <div class="radio-group">
                <input type="radio" id="region_coastal" name="region" value="coastal">
                <label for="region_coastal" style="width: auto;">Coastal</label>
            </div>
            <div class="radio-group">
                <input type="radio" id="region_mountain" name="region" value="mountain">
                <label for="region_mountain" style="width: auto;">Mountain</label>
            </div>
            <div class="radio-group">
                <input type="radio" id="region_tropical" name="region" value="tropical">
                <label for="region_tropical" style="width: auto;">Tropical</label>
            </div>
            <div class="radio-group">
                <input type="radio" id="region_desert" name="region" value="desert">
                <label for="region_desert" style="width: auto;">Desert</label>
            </div>
            <div class="radio-group">
                <input type="radio" id="region_forest" name="region" value="forest">
                <label for="region_forest" style="width: auto;">Forest</label>
            </div>
            <div class="radio-group">
                <input type="radio" id="region_river" name="region" value="river_basin">
                <label for="region_river" style="width: auto;">River Basin</label>
            </div>
            <div class="radio-group">
                <input type="radio" id="region_grassland" name="region" value="grassland">
                <label for="region_grassland" style="width: auto;">Grassland</label>
            </div>
            <div class="radio-group">
                <input type="radio" id="region_cold" name="region" value="cold">
                <label for="region_cold" style="width: auto;">Cold</label>
            </div>
        </div>

        <h2>Current Weather</h2>
        <div class="form-group">
            <div class="radio-group">
                <input type="radio" id="weather_sunny" name="weather" value="sunny" required>
                <label for="weather_sunny" style="width: auto;">Sunny</label>
            </div>
            <div class="radio-group">
                <input type="radio" id="weather_rainy" name="weather" value="rainy">
                <label for="weather_rainy" style="width: auto;">Rainy</label>
            </div>
            <div class="radio-group">
                <input type="radio" id="weather_cloudy" name="weather" value="cloudy">
                <label for="weather_cloudy" style="width: auto;">Cloudy</label>
            </div>
            <div class="radio-group">
                <input type="radio" id="weather_snowy" name="weather" value="snowy">
                <label for="weather_snowy" style="width: auto;">Snowy</label>
            </div>
            <div class="radio-group">
                <input type="radio" id="weather_windy" name="weather" value="windy">
                <label for="weather_windy" style="width: auto;">Windy</label>
            </div>
            <div class="radio-group">
                <input type="radio" id="weather_foggy" name="weather" value="foggy">
                <label for="weather_foggy" style="width: auto;">Foggy</label>
            </div>
            <div class="radio-group">
                <input type="radio" id="weather_stormy" name="weather" value="stormy">
                <label for="weather_stormy" style="width: auto;">Stormy</label>
            </div>
            <div class="radio-group">
                <input type="radio" id="weather_sweaty" name="weather" value="sweaty">
                <label for="weather_sweaty" style="width: auto;">Sweaty</label>
            </div>
        </div>

        <h2>Symptoms Duration</h2>
        <div class="form-group">
            <div class="radio-group">
                <input type="radio" id="duration_recent" name="symptom_duration" value="recent" required>
                <label for="duration_recent" style="width: auto;">Recent (&lt;5 days)</label>
            </div>
            <div class="radio-group">
                <input type="radio" id="duration_moderate" name="symptom_duration" value="moderate">
                <label for="duration_moderate" style="width: auto;">Moderate (5-15 days)</label>
            </div>
            <div class="radio-group">
                <input type="radio" id="duration_long" name="symptom_duration" value="long">
                <label for="duration_long" style="width: auto;">Long (&gt;15 days)</label>
            </div>
        </div>

        <button type="submit">Get Prediction</button>
    </form>

    <div id="output"></div>

    <script>
        document.getElementById('predictionForm').addEventListener('submit', async function(event) {
            event.preventDefault();
            
            // Show loading state
            const outputDiv = document.getElementById('output');
            outputDiv.innerHTML = '<p>Processing your request... Please wait.</p>';
            
            // Collect form data
            const formData = {
                symptoms: document.getElementById('symptoms').value,
                clinical_data: {
                    Age: parseInt(document.getElementById('age').value),
                    Weight: parseInt(document.getElementById('weight').value),
                    BP: parseInt(document.getElementById('bp').value),
                    Sugar: parseInt(document.getElementById('sugar').value),
                    Cholesterol: parseInt(document.getElementById('cholesterol').value),
                    WBC: parseInt(document.getElementById('wbc').value),
                    BMI: parseFloat(document.getElementById('bmi').value),
                    Sleep: parseFloat(document.getElementById('sleep').value)
                },
                environmental_data: {
                    temperature: document.querySelector('input[name="temperature"]:checked').value,
                    humidity: document.querySelector('input[name="humidity"]:checked').value,
                    air_quality: document.querySelector('input[name="air_quality"]:checked').value,
                    water_quality: document.querySelector('input[name="water_quality"]:checked').value,
                    region_type: document.querySelector('input[name="region"]:checked').value,
                    weather: document.querySelector('input[name="weather"]:checked').value,
                    time_delay: document.querySelector('input[name="symptom_duration"]:checked').value
                }
            };
            
            try {
                // Send data to FastAPI backend
                const response = await fetch('http://localhost:1200/predict', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });
                
                if (!response.ok) {
                    throw new Error(`Server error: ${response.status}`);
                }
                
                const predictions = await response.json();
                
                // Display results
                let html = '<h2>Prediction Results</h2>';
                
                predictions.forEach(pred => {
                    html += `
                        <div class="prediction">
                            <h3>${pred.disease}</h3>
                            <p>Confidence: ${(pred.confidence * 100).toFixed(1)}%</p>
                            <p>Risk Percentage: ${(pred.risk_percentage * 100).toFixed(1)}%</p>
                            <p>Severity Factor: ${pred.severity_factor.toFixed(1)}x</p>
                            <p>Symptom Matches: ${pred.symptom_matches}</p>
                            ${pred.warning ? `<p class="warning">⚠️ ${pred.warning}</p>` : ''}
                        </div>
                    `;
                });
                
                outputDiv.innerHTML = html;
                
            } catch (error) {
                outputDiv.innerHTML = `<p class="warning">Error: ${error.message}</p>`;
                console.error('Error:', error);
            }
        });
    </script>
</body>
</html>